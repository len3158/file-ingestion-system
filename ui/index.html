<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>File Ingestion UI</title>
    <style> table { border-collapse: collapse; } th, td { border: 1px solid #ddd; padding: 8px; } </style>
</head>
<body>
<h1>File Metadata</h1>
<table id="metadataTable">
    <thead><tr><th>Filename</th><th>Size</th><th>SHA256</th><th>Status</th><th>Reason</th><th>Path</th><th>Actions</th></tr></thead>
    <tbody></tbody>
</table>
<button onclick="fetchMetadata()">Refresh</button>
<script>
    async function fetchMetadata() {
        const response = await fetch('http://localhost:8080/api/files');
        const data = await response.json();
        const tbody = document.querySelector('#metadataTable tbody');
        tbody.innerHTML = '';
        data.forEach(item => {
            const row = `<tr><td>${item.filename}</td><td>${item.size}</td><td>${item.sha256}</td><td>${item.status}</td><td>${item.reason || ''}</td><td>${item.path}</td><td><button onclick="retryFile('${item.filename}')">Retry</button></td></tr>`;
            tbody.innerHTML += row;
        });
    }
    async function retryFile(filename) {
        await fetch(`http://localhost:8080/api/retry/${filename}`, { method: 'POST' });
        alert('Retry triggered');
        await fetchMetadata();
    }
    fetchMetadata();
</script>
</body>
</html>